{% extends "../base/base.html" %}

{% load static %}

{% block title %} {{ lesson.name }} {% endblock title %}

{% block external_styles %}
<link rel="stylesheet" href="{% static 'main/css/lesson_detail.css' %}">

<link href="https://unpkg.com/video.js/dist/video-js.min.css" rel="stylesheet">
<link href="https://unpkg.com/@videojs/themes@1/dist/forest/index.css" rel="stylesheet">
{% endblock external_styles %}

{% block external_scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/video.js/7.10.2/video.min.js"></script>
{% endblock external_scripts %}

{% block content %}
<h3 class="lesson__name">{{ lesson.name | upper }}</h3>

<div class="lesson__description">
  {{ lesson.parsed_description | safe }}
</div>

<div class="lesson__videos">
  {% for lesson_video in lesson.videos.all %}
  <div class="lesson-video-and-description-container">
    <div class="lesson__video-container">
      <video-js id="lesson-video-{{ forloop.counter }}" class="video-js vjs-theme-forest" data-setup="{}"
                controls preload="auto" controlsList="nodownload" oncontextmenu="return false">
        <source src="{{ lesson_video.file.url }}" type="video/mp4">
      </video-js>
    </div>
    <div class="lesson__video-description">
      {{ lesson_video.parsed_description | safe }}
    </div>
  </div>
  {% endfor %}
</div>
<div class="lesson__body markdown">
  {{ lesson.parsed_body | safe }}
</div>
{% if boolean %}
<form class="mt-3" method="post" action="{% url 'lesson_completed' id_course=course.id id_lesson=lesson.id %}">
  {% csrf_token %}
  <button class="btn btn-success rounded-0" type="submit">I have completed this lesson</button>
</form>
{% endif %}
{% endblock %}
